{"ast":null,"code":"/**\n * @module ol/renderer/vector\n */\nimport { getUid } from '../util.js';\nimport ImageState from '../ImageState.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport ReplayType from '../render/ReplayType.js';\n\n/**\n * Tolerance for geometry simplification in device pixels.\n * @type {number}\n */\nvar SIMPLIFY_TOLERANCE = 0.5;\n\n/**\n * @const\n * @type {Object<import(\"../geom/GeometryType.js\").default,\n *                function(import(\"../render/ReplayGroup.js\").default, import(\"../geom/Geometry.js\").default,\n *                         import(\"../style/Style.js\").default, Object)>}\n */\nvar GEOMETRY_RENDERERS = {\n  'Point': renderPointGeometry,\n  'LineString': renderLineStringGeometry,\n  'Polygon': renderPolygonGeometry,\n  'MultiPoint': renderMultiPointGeometry,\n  'MultiLineString': renderMultiLineStringGeometry,\n  'MultiPolygon': renderMultiPolygonGeometry,\n  'GeometryCollection': renderGeometryCollectionGeometry,\n  'Circle': renderCircleGeometry\n};\n\n/**\n * @param {import(\"../Feature.js\").FeatureLike} feature1 Feature 1.\n * @param {import(\"../Feature.js\").FeatureLike} feature2 Feature 2.\n * @return {number} Order.\n */\nexport function defaultOrder(feature1, feature2) {\n  return parseInt(getUid(feature1), 10) - parseInt(getUid(feature2), 10);\n}\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Squared pixel tolerance.\n */\nexport function getSquaredTolerance(resolution, pixelRatio) {\n  var tolerance = getTolerance(resolution, pixelRatio);\n  return tolerance * tolerance;\n}\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Pixel tolerance.\n */\nexport function getTolerance(resolution, pixelRatio) {\n  return SIMPLIFY_TOLERANCE * resolution / pixelRatio;\n}\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Circle.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderCircleGeometry(replayGroup, geometry, style, feature) {\n  var fillStyle = style.getFill();\n  var strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    var circleReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.CIRCLE);\n    circleReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    circleReplay.drawCircle(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {function(this: T, import(\"../events/Event.js\").default)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @return {boolean} `true` if style is loading.\n * @template T\n */\nexport function renderFeature(replayGroup, feature, style, squaredTolerance, listener, thisArg) {\n  var loading = false;\n  var imageStyle = style.getImage();\n  if (imageStyle) {\n    var imageState = imageStyle.getImageState();\n    if (imageState == ImageState.LOADED || imageState == ImageState.ERROR) {\n      imageStyle.unlistenImageChange(listener, thisArg);\n    } else {\n      if (imageState == ImageState.IDLE) {\n        imageStyle.load();\n      }\n      imageState = imageStyle.getImageState();\n      imageStyle.listenImageChange(listener, thisArg);\n      loading = true;\n    }\n  }\n  renderFeatureInternal(replayGroup, feature, style, squaredTolerance);\n  return loading;\n}\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n */\nfunction renderFeatureInternal(replayGroup, feature, style, squaredTolerance) {\n  var geometry = style.getGeometryFunction()(feature);\n  if (!geometry) {\n    return;\n  }\n  var simplifiedGeometry = geometry.getSimplifiedGeometry(squaredTolerance);\n  var renderer = style.getRenderer();\n  if (renderer) {\n    renderGeometry(replayGroup, simplifiedGeometry, style, feature);\n  } else {\n    var geometryRenderer = GEOMETRY_RENDERERS[simplifiedGeometry.getType()];\n    geometryRenderer(replayGroup, simplifiedGeometry, style, feature);\n  }\n}\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Geometry.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderGeometry(replayGroup, geometry, style, feature) {\n  if (geometry.getType() == GeometryType.GEOMETRY_COLLECTION) {\n    var geometries = /** @type {import(\"../geom/GeometryCollection.js\").default} */geometry.getGeometries();\n    for (var i = 0, ii = geometries.length; i < ii; ++i) {\n      renderGeometry(replayGroup, geometries[i], style, feature);\n    }\n    return;\n  }\n  var replay = replayGroup.getReplay(style.getZIndex(), ReplayType.DEFAULT);\n  replay.drawCustom( /** @type {import(\"../geom/SimpleGeometry.js\").default} */geometry, feature, style.getRenderer());\n}\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/GeometryCollection.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderGeometryCollectionGeometry(replayGroup, geometry, style, feature) {\n  var geometries = geometry.getGeometriesArray();\n  var i, ii;\n  for (i = 0, ii = geometries.length; i < ii; ++i) {\n    var geometryRenderer = GEOMETRY_RENDERERS[geometries[i].getType()];\n    geometryRenderer(replayGroup, geometries[i], style, feature);\n  }\n}\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/LineString.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderLineStringGeometry(replayGroup, geometry, style, feature) {\n  var strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    var lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawLineString(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/MultiLineString.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderMultiLineStringGeometry(replayGroup, geometry, style, feature) {\n  var strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    var lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawMultiLineString(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/MultiPolygon.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderMultiPolygonGeometry(replayGroup, geometry, style, feature) {\n  var fillStyle = style.getFill();\n  var strokeStyle = style.getStroke();\n  if (strokeStyle || fillStyle) {\n    var polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawMultiPolygon(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Point.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderPointGeometry(replayGroup, geometry, style, feature) {\n  var imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    var imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawPoint(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/MultiPoint.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderMultiPointGeometry(replayGroup, geometry, style, feature) {\n  var imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    var imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawMultiPoint(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Polygon.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderPolygonGeometry(replayGroup, geometry, style, feature) {\n  var fillStyle = style.getFill();\n  var strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    var polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawPolygon(geometry, feature);\n  }\n  var textStyle = style.getText();\n  if (textStyle) {\n    var textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}","map":{"version":3,"sources":["../../../src/ol/renderer/vector.js"],"names":["const","let"],"mappings":"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","sourcesContent":["/**\n * @module ol/renderer/vector\n */\nimport {getUid} from '../util.js';\nimport ImageState from '../ImageState.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport ReplayType from '../render/ReplayType.js';\n\n\n/**\n * Tolerance for geometry simplification in device pixels.\n * @type {number}\n */\nconst SIMPLIFY_TOLERANCE = 0.5;\n\n\n/**\n * @const\n * @type {Object<import(\"../geom/GeometryType.js\").default,\n *                function(import(\"../render/ReplayGroup.js\").default, import(\"../geom/Geometry.js\").default,\n *                         import(\"../style/Style.js\").default, Object)>}\n */\nconst GEOMETRY_RENDERERS = {\n  'Point': renderPointGeometry,\n  'LineString': renderLineStringGeometry,\n  'Polygon': renderPolygonGeometry,\n  'MultiPoint': renderMultiPointGeometry,\n  'MultiLineString': renderMultiLineStringGeometry,\n  'MultiPolygon': renderMultiPolygonGeometry,\n  'GeometryCollection': renderGeometryCollectionGeometry,\n  'Circle': renderCircleGeometry\n};\n\n\n/**\n * @param {import(\"../Feature.js\").FeatureLike} feature1 Feature 1.\n * @param {import(\"../Feature.js\").FeatureLike} feature2 Feature 2.\n * @return {number} Order.\n */\nexport function defaultOrder(feature1, feature2) {\n  return parseInt(getUid(feature1), 10) - parseInt(getUid(feature2), 10);\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Squared pixel tolerance.\n */\nexport function getSquaredTolerance(resolution, pixelRatio) {\n  const tolerance = getTolerance(resolution, pixelRatio);\n  return tolerance * tolerance;\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Pixel tolerance.\n */\nexport function getTolerance(resolution, pixelRatio) {\n  return SIMPLIFY_TOLERANCE * resolution / pixelRatio;\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Circle.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderCircleGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const circleReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.CIRCLE);\n    circleReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    circleReplay.drawCircle(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {function(this: T, import(\"../events/Event.js\").default)} listener Listener function.\n * @param {T} thisArg Value to use as `this` when executing `listener`.\n * @return {boolean} `true` if style is loading.\n * @template T\n */\nexport function renderFeature(replayGroup, feature, style, squaredTolerance, listener, thisArg) {\n  let loading = false;\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    let imageState = imageStyle.getImageState();\n    if (imageState == ImageState.LOADED || imageState == ImageState.ERROR) {\n      imageStyle.unlistenImageChange(listener, thisArg);\n    } else {\n      if (imageState == ImageState.IDLE) {\n        imageStyle.load();\n      }\n      imageState = imageStyle.getImageState();\n      imageStyle.listenImageChange(listener, thisArg);\n      loading = true;\n    }\n  }\n  renderFeatureInternal(replayGroup, feature, style, squaredTolerance);\n\n  return loading;\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n */\nfunction renderFeatureInternal(replayGroup, feature, style, squaredTolerance) {\n  const geometry = style.getGeometryFunction()(feature);\n  if (!geometry) {\n    return;\n  }\n  const simplifiedGeometry = geometry.getSimplifiedGeometry(squaredTolerance);\n  const renderer = style.getRenderer();\n  if (renderer) {\n    renderGeometry(replayGroup, simplifiedGeometry, style, feature);\n  } else {\n    const geometryRenderer = GEOMETRY_RENDERERS[simplifiedGeometry.getType()];\n    geometryRenderer(replayGroup, simplifiedGeometry, style, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Geometry.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderGeometry(replayGroup, geometry, style, feature) {\n  if (geometry.getType() == GeometryType.GEOMETRY_COLLECTION) {\n    const geometries = /** @type {import(\"../geom/GeometryCollection.js\").default} */ (geometry).getGeometries();\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      renderGeometry(replayGroup, geometries[i], style, feature);\n    }\n    return;\n  }\n  const replay = replayGroup.getReplay(style.getZIndex(), ReplayType.DEFAULT);\n  replay.drawCustom(/** @type {import(\"../geom/SimpleGeometry.js\").default} */ (geometry), feature, style.getRenderer());\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/GeometryCollection.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderGeometryCollectionGeometry(replayGroup, geometry, style, feature) {\n  const geometries = geometry.getGeometriesArray();\n  let i, ii;\n  for (i = 0, ii = geometries.length; i < ii; ++i) {\n    const geometryRenderer =\n        GEOMETRY_RENDERERS[geometries[i].getType()];\n    geometryRenderer(replayGroup, geometries[i], style, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/LineString.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderLineStringGeometry(replayGroup, geometry, style, feature) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawLineString(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/MultiLineString.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderMultiLineStringGeometry(replayGroup, geometry, style, feature) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawMultiLineString(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/MultiPolygon.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderMultiPolygonGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (strokeStyle || fillStyle) {\n    const polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawMultiPolygon(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Point.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderPointGeometry(replayGroup, geometry, style, feature) {\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawPoint(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/MultiPoint.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderMultiPointGeometry(replayGroup, geometry, style, feature) {\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, replayGroup.addDeclutter(false));\n    imageReplay.drawMultiPoint(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/ReplayGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Polygon.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderPolygonGeometry(replayGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const polygonReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawPolygon(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = replayGroup.getReplay(style.getZIndex(), ReplayType.TEXT);\n    textReplay.setTextStyle(textStyle, replayGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n"]},"metadata":{},"sourceType":"module"}